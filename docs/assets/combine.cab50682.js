import{_ as b}from"./OperateBox.50437538.js";import{a as _,b as w,E as v,o as x,c as k,w as r,d as m,e as u}from"./index.aede304e.js";/* empty css                  */import{D as E}from"./dialog.5b3a1201.js";const I={__name:"combine",setup(B){const a=_(),{viewer:s}=window,p=()=>{s.dataSources.add(new Cesium.GeoJsonDataSource().load("/cesium-vue3-vite/json/chuzhong.geojson").then(e=>(e.clustering.enabled=!0,e.clustering.pixelRange=60,e.clustering.minimumClusterSize=2,e.entities.values.forEach(o=>{o.position._value.z+=2e3,o._id=`mark-${o.id}`,o.billboard={image:"/cesium-vue3-vite/images/mark-icon.png",width:32,height:32}}),e.clustering.clusterEvent.addEventListener((o,n)=>{n.label.show=!1,n.billboard.show=!0,n.billboard.verticalOrigin=Cesium.VerticalOrigin.BOTTOM,console.log("clusteredEntities",o),console.log("cluster",n),n.billboard.image=g("/cesium-vue3-vite/images/mark-icon.png",o.length,64),n.billboard.width=40,n.billboard.height=40}),e)))};function g(e,o,n){let t=document.createElement("canvas");t.width=n,t.height=n;let i=t.getContext("2d");return new Cesium.Resource.fetchImage(e).then(f=>{try{i.drawImage(f,0,0)}catch(h){console.log(h)}return i.fillStyle=Cesium.Color.BLACK.toCssColorString(),i.font="bold 20px Microsoft YaHei",i.textAlign="center",i.textBaseline="middle",i.fillText(o,n/2,n/2),t})}s.camera.setView({destination:Cesium.Cartesian3.fromDegrees(120.36,36.09,4e4)});const c=s.scene;new Cesium.ScreenSpaceEventHandler(c.canvas).setInputAction(e=>{var i;const o=s.scene.camera.pickEllipsoid(e.position),n=Cesium.Cartographic.fromCartesian(o),t=c.pick(e.position);if(Cesium.defined(t)&&((i=t.id)==null?void 0:i.id.indexOf("mark"))>-1){s.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(Cesium.Math.toDegrees(n.longitude),Cesium.Math.toDegrees(n.latitude),1e4),duration:1});const l=Object.assign(t.id,{viewer:s,title:t.id.name,content:t.id.properties.address._value});console.log("---",t.id,l),a.value&&a.value.windowClose(),a.value=new E(l)}},Cesium.ScreenSpaceEventType.LEFT_CLICK);const C=()=>{var e;(e=a.value)==null||e.windowClose()},d=()=>{var e;C(),(e=s.dataSources)==null||e.removeAll()};return w(()=>{d()}),(e,o)=>{const n=v,t=b;return x(),k(t,null,{default:r(()=>[m(n,{type:"primary",onClick:p},{default:r(()=>o[0]||(o[0]=[u("\u6253\u70B9")])),_:1}),m(n,{type:"primary",onClick:d},{default:r(()=>o[1]||(o[1]=[u("\u6E05\u9664\u6253\u70B9")])),_:1})]),_:1})}}};export{I as default};
