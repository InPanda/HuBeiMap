import{G as M}from"./dat.gui.module.6914edc7.js";import{l as b,b as D,o as T,f as P}from"./index.aede304e.js";const{viewer:R}=window,c={};c.getCurrentMousePosition=function(t,e,i){var a,n=t.pick(e);if(t.pickPositionSupported&&Cesium.defined(n)){var r=n.id;if(i==null||i&&r!==i){var a=t.pickPosition(e);if(Cesium.defined(a)){var m=Cesium.Cartographic.fromCartesian(a),s=m.height;if(s>=0||!Cesium.defined(n.id)&&s>=-500)return a}}}if(t.mode===Cesium.SceneMode.SCENE3D){var l=t.camera.getPickRay(e);a=t.globe.pick(l,t)}else a=t.camera.pickEllipsoid(e,t.globe.ellipsoid);return a};c.getCenter=function(t){var e=t.scene,i=F(e),a=i;if(!a){var n=e.globe,r=e.camera.positionCartographic.clone(),m=n.getHeight(r);r.height=m||0,a=Cesium.Ellipsoid.WGS84.cartographicToCartesian(r)}var s=c.formatPositon(a),l=Cesium.Cartesian3.distance(a,t.scene.camera.positionWC);return s.cameraZ=l,s};function F(t){var e=t.canvas,i=new Cesium.Cartesian2(e.clientWidth/2,e.clientHeight/2),a=t.camera.getPickRay(i),n=t.globe.pick(a,t);return n||t.camera.pickEllipsoid(i)}c.getExtent=function(t){var e={xmin:70,xmax:140,ymin:0,ymax:55},i=t.scene,a=i.globe.ellipsoid,n=i.canvas,r=t.camera.pickEllipsoid(new Cesium.Cartesian2(0,0),a);if(r){var m=a.cartesianToCartographic(r);e.xmin=Cesium.Math.toDegrees(m.longitude),e.ymax=Cesium.Math.toDegrees(m.latitude)}else{for(var s=n.width/2,l=n.height/2,u,o=0;o<=l;o+=10){var C=o<=s?o:s;if(u=t.camera.pickEllipsoid(new Cesium.Cartesian2(C,o),a),u)break}if(u){var m=a.cartesianToCartographic(u);e.xmin=Cesium.Math.toDegrees(m.longitude),e.ymax=Cesium.Math.toDegrees(m.latitude)}}var g=t.camera.pickEllipsoid(new Cesium.Cartesian2(n.width,n.height),a);if(g){var h=a.cartesianToCartographic(g);e.xmax=Cesium.Math.toDegrees(h.longitude),e.ymin=Cesium.Math.toDegrees(h.latitude)}else{for(var s=n.width/2,l=n.height/2,d,o=n.height;o>=l;o-=10){var C=o>=s?o:s;if(d=t.camera.pickEllipsoid(new Cesium.Cartesian2(C,o),a),d)break}if(d){var h=a.cartesianToCartographic(d);e.xmax=Cesium.Math.toDegrees(h.longitude),e.ymin=Cesium.Math.toDegrees(h.latitude)}}if(e.xmax<e.xmin){var f=e.xmax;e.xmax=e.xmin,e.xmin=f}if(e.ymax<e.ymin){var f=e.ymax;e.ymax=e.ymin,e.ymin=f}return e};c.getViewBounds=function(t){var e=t.camera.computeViewRectangle(),i=e.west/Math.PI*180,a=e.north/Math.PI*180,n=e.east/Math.PI*180,r=e.south/Math.PI*180,m={southwest:{lng:i,lat:r},northeast:{lng:n,lat:a}};return m};c.getCameraView=function(t){var e=t.camera,i=e.positionCartographic,a={};return a.y=Number(Cesium.Math.toDegrees(i.latitude).toFixed(6)),a.x=Number(Cesium.Math.toDegrees(i.longitude).toFixed(6)),a.z=Number(i.height.toFixed(1)),a.heading=Number(Cesium.Math.toDegrees(e.heading||-90).toFixed(1)),a.pitch=Number(Cesium.Math.toDegrees(e.pitch||0).toFixed(1)),a.roll=Number(Cesium.Math.toDegrees(e.roll||0).toFixed(1)),a};c.formatPositon=function(t){var e=Cesium.Cartographic.fromCartesian(t),i={};return i.y=Number(Cesium.Math.toDegrees(e.latitude).toFixed(6)),i.x=Number(Cesium.Math.toDegrees(e.longitude).toFixed(6)),i.z=Number(e.height.toFixed(1)),i};c.Cartesian3To=function(t,e){if(t){if(e){var i=e.scene.globe.ellipsoid,a;a=i.cartesianToCartographic(t)}else a=Cesium.Cartographic.fromCartesian(t);var n=Cesium.Math.toDegrees(a.latitude),r=Cesium.Math.toDegrees(a.longitude),m=a.height;return{cartesian3:t,cartographic:a,latlng:{lat:n,lng:r,height:m}}}};c.windingPoint={isStart:!1,viewer:null,start:function(t,e){e||(e=c.getCenter(t)),this.viewer=t,this.position=Cesium.Cartesian3.fromDegrees(e.x,e.y,e.z),this.distance=e.distance||Cesium.Cartesian3.distance(this.position,t.camera.positionWC),this.angle=360/(e.time||60),this.time=t.clock.currentTime.clone(),this.heading=t.camera.heading,this.pitch=t.camera.pitch,this.viewer.clock.onTick.addEventListener(this.clock_onTickHandler,this),this.isStart=!0},clock_onTickHandler:function(t){var e=Cesium.JulianDate.secondsDifference(this.viewer.clock.currentTime,this.time),i=Cesium.Math.toRadians(e*this.angle)+this.heading;this.viewer.scene.camera.setView({destination:this.position,orientation:{heading:i,pitch:this.pitch}}),this.viewer.scene.camera.moveBackward(this.distance)},stop:function(){!this.isStart||(this.viewer&&this.viewer.clock.onTick.removeEventListener(this.clock_onTickHandler,this),this.isStart=!1)}};c.aroundPoint={isStart:!1,viewer:null,start:function(t,e){e||(e=c.getCenter(t)),this.viewer=t,this.position=Cesium.Cartesian3.fromDegrees(e.x,e.y,e.z),this.angle=360/(e.time||60),this.time=t.clock.currentTime.clone(),this.heading=t.camera.heading,this.pitch=t.camera.pitch,this.viewer.clock.onTick.addEventListener(this.clock_onTickHandler,this),this.isStart=!0},clock_onTickHandler:function(t){var e=Cesium.JulianDate.secondsDifference(this.viewer.clock.currentTime,this.time),i=Cesium.Math.toRadians(e*this.angle)+this.heading;R.scene.camera.setView({orientation:{heading:i,pitch:this.pitch}})},stop:function(){!this.isStart||(this.viewer&&this.viewer.clock.onTick.removeEventListener(this.clock_onTickHandler,this),this.isStart=!1)}};const I={__name:"viewFrustum",setup(t){const{viewer:e}=window,i={x:120,y:30,z:2e3,heading:0,pitch:180,roll:0,fov:30,near:10,far:3e3,aspectRatio:1.4};let a,n,r;b(()=>{e.camera.setView({destination:Cesium.Cartesian3.fromDegrees(120,30,2e4)}),r=new M,r.domElement.style="position:absolute;top:10px;left:10px;",r.add(i,"x",-180,180).name("\u7ECF\u5EA6").onChange(s),r.add(i,"y",-90,90).name("\u7EAC\u5EA6").onChange(s),r.add(i,"z",100,1e4).name("\u9AD8\u5EA6").onChange(s),r.add(i,"heading",0,360).name("\u504F\u822A\u89D2-\u6C34\u5E73").onChange(s),r.add(i,"pitch",0,360).name("\u4FEF\u4EF0\u89D2-\u4E0A\u4E0B").onChange(s),r.add(i,"roll",0,360).name("\u7FFB\u6EDA\u89D2-\u4FA7\u5411").onChange(s),r.add(i,"fov",0,180).name("\u4E0A\u4E0B\u89D2\u5EA6").onChange(s),r.add(i,"near",0,1e3).name("\u8FD1\u8DDD").onChange(s),r.add(i,"far",0,5e3).name("\u8FDC\u8DDD").onChange(s),r.add(i,"aspectRatio",0,3).name("\u6A2A\u5411\u6BD4\u4F8B").onChange(s),m()}),D(()=>{r&&r.destroy(),a&&e.scene.primitives.remove(a),n&&e.scene.primitives.remove(n)});function m(){var u=Cesium.Cartesian3.fromDegrees(i.x,i.y,i.z),o=Cesium.Math.toRadians(i.heading),C=Cesium.Math.toRadians(i.pitch),g=Cesium.Math.toRadians(i.roll),h=new Cesium.HeadingPitchRoll(o,C,g),d=Cesium.Transforms.headingPitchRollQuaternion(u,h);l(u,d,i.fov,i.near,i.far,i.aspectRatio)}function s(){e.scene.primitives.remove(a),e.scene.primitives.remove(n);var u=Cesium.Cartesian3.fromDegrees(i.x,i.y,i.z),o=Cesium.Math.toRadians(i.heading),C=Cesium.Math.toRadians(i.pitch),g=Cesium.Math.toRadians(i.roll),h=new Cesium.HeadingPitchRoll(o,C,g),d=Cesium.Transforms.headingPitchRollQuaternion(u,h);l(u,d,i.fov,i.near,i.far,i.aspectRatio)}function l(u,o,C,g,h,d){let f=new Cesium.PerspectiveFrustum({fov:Cesium.Math.toRadians(C),aspectRatio:d,near:g,far:h}),p=new Cesium.GeometryInstance({geometry:new Cesium.FrustumGeometry({frustum:f,origin:u,orientation:o,vertexFormat:Cesium.VertexFormat.POSITION_ONLY}),attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(Cesium.Color.AQUA.withAlpha(.3))}}),y=new Cesium.GeometryInstance({geometry:new Cesium.FrustumOutlineGeometry({frustum:f,origin:u,orientation:o}),attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(new Cesium.Color(1,1,1,1))}});a=new Cesium.Primitive({geometryInstances:[p],appearance:new Cesium.PerInstanceColorAppearance({closed:!0,flat:!0}),asynchronous:!1}),n=new Cesium.Primitive({geometryInstances:[y],appearance:new Cesium.PerInstanceColorAppearance({closed:!0,flat:!0}),asynchronous:!1}),e.scene.primitives.add(a),e.scene.primitives.add(n);const x=Cesium.FrustumOutlineGeometry.createGeometry(p.geometry).attributes.position.values,k=[];for(let v=0;v<x.length;v+=3)k.push(x.slice(v,v+3));const w=[];k.forEach(function(v){w.push(c.formatPositon(new Cesium.Cartesian3(v[0],v[1],v[2])))}),console.log("\u89C6\u9525\u4F53\u9876\u70B9\u5750\u6807\uFF1A",w)}return(u,o)=>(T(),P("div"))}};export{I as default};
